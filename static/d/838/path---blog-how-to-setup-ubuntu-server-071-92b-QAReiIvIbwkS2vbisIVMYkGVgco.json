{"data":{"site":{"siteMetadata":{"title":"Kyle Alwyn","author":"Kyle Alwyn"}},"markdownRemark":{"id":"824c191b-7858-53e3-be48-ab8bce9440c6","excerpt":"Let’s face it. It can be overwhelming starting at a blank terminal thinking of how to initially get our server going. I’ve been playing…","html":"<p>Let’s face it. It can be overwhelming starting at a blank terminal thinking of how to initially get our server going. I’ve been playing around with servers at <a href=\"http://digitalocean.com\">Digital Ocean</a> and wanted to write down my workflow not only to help others, but for my reference as well. I may also use server and box synonymously.</p>\n<h2>First Login</h2>\n<p>There are a few simple steps to get going in the right direction after logging into the server for the first time.</p>\n<ol>\n<li>Login via SSH</li>\n<li><code class=\"language-text\">ssh root@&lt;ipaddr&gt;</code></li>\n<li>Change root password</li>\n<li><code class=\"language-text\">passwd</code></li>\n<li>Create a new user</li>\n<li><code class=\"language-text\">adduser &lt;newuser&gt;</code></li>\n<li>Give user sudo access</li>\n<li><code class=\"language-text\">gpasswd -a &lt;newuser&gt; sudo</code></li>\n</ol>\n<h2>Add Public/Private Key Authentication</h2>\n<p>Next, it’s time to set up SSH logins. It’s tedious to have to input our password everytime we log into our box, so let’s get rid of that step.</p>\n<p>First, on your local machine, we’ll need to generate an RSA public and private key. You may skip this if you already have a generated key.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># Generate our RSA key and go through the steps. Default path is fine and I recommend no password\n$ ssh-keygen -t rsa\n\n# Print out our new public key so we can copy\n$ cat ~/.ssh/id_rsa.pub</code></pre></div>\n<p>Let’s log back into our server as the root user and configure the user we created in the previous section to accept our newly generated key as a login.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># On server as root, enter in new user’s shell\n$ su - &lt;newuser&gt;\n\n# Now create the ssh directory in the new users home directory\n$ cd ~\n$ mkdir .ssh\n$ chmod -R 700 .ssh\n$ vim .ssh/authorized_keys\n# Paste in public key\n$ chmod 600 .ssh/authorized_keys\n$ exit</code></pre></div>\n<p>Sweet. Now we should be able to login directly to our server without having to input our password. Try it out to verify.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># Back on local machine\n$ ssh &lt;newuser&gt;@&lt;ipaddr&gt;</code></pre></div>\n<h2>Securing SSH</h2>\n<p>Now that we can login directly to our server using SSH, we will want to make SSH a bit more secure to prevent any breaches. Some security experts recommend to change the SSH port off of 22, as this is the most common port that hackers use to try and brute force their way into your server. We also disallow the root user from logging in remotely to the server as we do not want anyone unwarranted with super capabilities. We may also choose to restrict which users are allowed to SSH into the box, but that’s up to you.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># Back on local machine\n# Open up etc/ssh/sshd_config\nPort &lt;portno&gt;\nPermitRootLogin no\n...\nUseDNS no\nAllowUsers &lt;newuser&gt;\n\n# Back in the shell, we need to restart ssh using one of the following commands\n# depending on your environment. Sudo may also need to be used.\nreload ssh or service ssh restart\n\n# Check to see whether new settings work\nssh -p &lt;portno&gt; &lt;newuser&gt;@&lt;ipaddr&gt;</code></pre></div>\n<h2>Firewall</h2>\n<p>To be extra secure, we may want to setup a firewall to restrict our server’s port access.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ apt-get install ufw\n$ ufw logging low\n$ ufw limit &lt;portno&gt;/tcp #ssh\n$ ufw allow 25/tcp       #mail\n$ ufw allow 80/tcp       #http\n$ ufw allow 443/tcp      #https\n$ ufw enable</code></pre></div>\n<h2>Installing Ruby</h2>\n<p>We are going to use <a href=\"http://rvm.io\">RVM</a> to manage our Ruby installation. Run the following commands to get RVM onto our machine</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># You may optionally append &#39;-s stable --rails&#39; to the second command install rails simultaneously\n$ gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3\n$ curl -sSL https://get.rvm.io | bash</code></pre></div>\n<p>This will append a couple lines to source RMV scripts upon shell login and we should be good to go! The script will install the latest stable version of ruby. Let’s verify ruby was installed successfully and check our ruby version.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ ruby -v\n# ruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-linux]</code></pre></div>\n<p>Nice, Ruby and Ruby on Rails (if you installed rails as well) are up and running on our machine.</p>\n<h2>Installing Node</h2>\n<p>We’ll use <a href=\"https://github.com/creationix/nvm\">NVM</a> (Node Version Manager) to install and manage NodeJs on our server.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># Always start by updating our packages\n$ apt-get update\n\n# Next, we&#39;ll install two necessary libraries for nvm to run properly.\n$ apt-get install build-essential libssl-dev\n\n# Finally, we&#39;ll install NVM using curl\n$ curl https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash</code></pre></div>\n<p>Make sure to restart your terminal or source your profile after installation to load NVM initially. 0.31.0 is the current version at the time of writing this, but you may replace it with whatever the current version is. You may find this by visiting the <a href=\"https://github.com/creationix/nvm\">NVM</a> repo on Github. This will append a few lines to your user profile that will automatically source NVM on login. We can now install Node on our Machine!</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ nvm --version\n# 0.31.0\n\n# Install the latest stable version of Node\n$ nvm install 5.0.0\n\n$ node -v\n# v5.0.0\n\n$ npm -v\n# 3.3.6</code></pre></div>\n<p>Boom! We now have <a href=\"https://nodejs.org/en/\">Node</a> and <a href=\"https://www.npmjs.com/\">NPM</a> installed and running on our system. We can now install any Node packages we want such as pm2 for Node app deployment by running <code class=\"language-text\">npm install -g pm2.</code></p>\n<h2>Nginx</h2>\n<p>First, install nginx from apt-get</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ apt-get update\n$ apt-get install nginx</code></pre></div>\n<p>That was easy. Go ahead and navigate to your IP address in the browser or a REST client such as Postman and you should see a welcome page.</p>\n<h2>MongoDB</h2>","frontmatter":{"title":"How to setup an Ubuntu server","date":"May 29, 2016","description":"The basic building blocks of setting up an Ubuntu server"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"how-to-setup-ubuntu-server","previous":{"frontmatter":{"slug":"how-to-use-sass-maps","title":"How to use Sass maps"}},"next":{"frontmatter":{"slug":"best-es6-features","title":"Best ES6 Features"}}}}